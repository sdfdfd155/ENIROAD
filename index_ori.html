<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>에니로드 - 길안내 경로</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 16px;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #f0f0f0;
        }

        header {
            background-color: #0080FF;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        header img {
            height: 50px;
        }

        main {
            padding: 20px;
            background-color: #fff;
            margin: 20px auto;
            max-width: 800px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .controls {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
        }

        .controls label {
            margin-right: 10px;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .controls input {
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .controls button {
            padding: 10px 20px;
            margin-right: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            background-color: #0080FF;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        .map-container {
            width: 100%;
            height: 500px;
            margin-bottom: 20px;
        }

        .results-container {
            display: flex;
            justify-content: space-between;
        }

        .results-container div {
            width: 32%;
            background-color: #f9f9f9;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        .large-text {
            font-size: 24px;
        }

        footer {
            text-align: center;
            padding: 20px;
            background-color: #0080FF;
            color: white;
        }
    </style>
    <script type="text/javascript"
        src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=c6dcc0c6916ba71802e3393158bab1bd&libraries=services"></script>
</head>

<body>
    <header>
        <img src="/mnt/data/Group_626592.png" alt="에니로드 로고">
    </header>
    <main>
        <div class="controls">
            <label for="start">출발지:</label>
            <input type="text" id="start" name="start">
            <label for="end">목적지:</label>
            <input type="text" id="end" name="end">
            <button id="routeButton" onclick="openRoute()">경로 보기</button>
            <button onclick="toggleTextSize()">글씨 크기 확대/축소</button>
            <button onclick="location.href='guide.html'">사용 방법</button>
        </div>
        <div id="map" class="map-container"></div>
    </main>
    <footer>
        &copy; 2024 에니로드
    </footer>
    <script>
        var mapContainer = document.getElementById('map'),
            mapOption = {
                center: new kakao.maps.LatLng(37.566826, 126.9786567),
                level: 3
            };

        var map = new kakao.maps.Map(mapContainer, mapOption);

        // HTML5의 geolocation으로 사용할 수 있는지 확인합니다 
        if (navigator.geolocation) {

            // GeoLocation을 이용해서 접속 위치를 얻어옵니다
            navigator.geolocation.getCurrentPosition(function (position) {

                var lat = position.coords.latitude, // 위도
                    lon = position.coords.longitude; // 경도

                var locPosition = new kakao.maps.LatLng(lat, lon) // geolocation으로 얻어온 좌표
                presentPosition = locPosition;

                map.setCenter(locPosition);

            });

        } else { // HTML5의 GeoLocation을 사용할 수 없을때 

            var locPosition = new kakao.maps.LatLng(37.566826, 126.9786567)
            alert('현재 위치를 찾을 수 없습니다!');
        }

        var geocoder = new kakao.maps.services.Geocoder();
        var marker = new kakao.maps.Marker();
        var infowindow = new kakao.maps.InfoWindow({ zindex: 1 });
        var startAddr = "";
        var endAddr = "";

        kakao.maps.event.addListener(map, 'click', function (mouseEvent) {
            searchDetailAddrFromCoords(mouseEvent.latLng, function (result, status) {
                if (status === kakao.maps.services.Status.OK) {
                    var detailAddr = !!result[0].road_address ? result[0].road_address.address_name : result[0].address.address_name;
                    if (!startAddr) {
                        startAddr = detailAddr;
                        document.getElementById('start').value = startAddr;
                    } else if (!endAddr) {
                        endAddr = detailAddr;
                        document.getElementById('end').value = endAddr;
                    } else {
                        alert("이미 출발지와 목적지가 설정되었습니다.");
                    }

                    var content = '<div class="bAddr">' +
                        '<span class="title">법정동 주소정보</span>' +
                        '<div>' + detailAddr + '</div>' +
                        '</div>';

                    marker.setPosition(mouseEvent.latLng);
                    marker.setMap(map);
                    infowindow.setContent(content);
                    infowindow.open(map, marker);
                }
            });
        });

        function searchDetailAddrFromCoords(coords, callback) {
            geocoder.coord2Address(coords.getLng(), coords.getLat(), callback);
        }

        function openRoute() {
            var start = document.getElementById('start').value;
            var end = document.getElementById('end').value;

            if (start && end) {
                var routeLink = `https://map.kakao.com/?sName=${encodeURIComponent(start)}&eName=${encodeURIComponent(end)}`;
                window.open(routeLink, '_blank');
            } else {
                alert("출발지와 목적지를 입력하거나 설정해주세요.");
            }
        }

        function toggleTextSize() {
            document.body.classList.toggle('large-text');
        }
    </script>
</body>

</html>
